---
id: 989
title: XenServer 5.0 Enterprise Ready?
date: 2009-03-10T12:44:43+02:00
author: Matthijs Haverink
layout: post
guid: https://svenhuisman.com/?p=989
permalink: /2009/03/xenserver-50-enterprise-ready/
categories:
  - Virtual Infrastructure
tags:
  - Citrix
  - Enterprise
  - Everrun VM
  - marathon
  - xenserver
---
Since 2 months I&#8217;ve been playing around with the new <span><span>enterpise</span></span> version of <span><span>XenServer</span></span> 5.0. As you can read in my first post my expectations of the new version were high. I&#8217;ve created a summary of <span><span>pro&#8217;s</span></span> and con&#8217;s. As far is I&#8217;m concerned <span><span>VMware</span></span> ESX server 3.5 Enterprise and <span><span>Citrix</span></span> <span><span>XenServer</span></span> 5.0 platinum are in the same league although some key features from ESX 3.5 are missing within <span><span>XenServer</span></span> and the other way around. Below you&#8217;ll find the way I created my test environment and all challenges I ran in to.  See for your self if you consider <span><span>XenServer</span></span> enterprise ready.

<!--more-->For the base purpose &#8220;

<span><span>Virtualize</span></span> Hardware&#8221; <span><span>XenServer</span></span> does the job. You can create several types of virtual machines with several types of Operating Systems. Although the first obstacle is the fact Intel-VT or AMD-V is required for <span><span>virtualizing</span></span> Windows machines (this is not the case for ESX). This makes it a lot <span>tougher</span> to re-use hardware (because most older hardware does not have this support). But OK in most new servers it&#8217;s integrated (and when you <span><span>wan&#8217;t</span></span> to play around at home please keep this in mind).

The installation procedure of a <span><span>XenServer</span></span> host is very simple and quick, just <span><span>plugin</span></span> the CD and within 5 minutes you&#8217;ll have a running Xenserver (I&#8217;ve seen several blogs posting the installation procedure so I&#8217;ll spare you the details).  In the rest of this post a configuration of 2 servers is used (because of a key difference between ESX and <span><span>XenServer</span></span>, I&#8217;ll get back on this later on). After installing my two <span><span>XenServer</span></span> hosts I install <span><span>XenCenter</span></span> on my laptop and connect my two <span><span>XenServers</span></span>. All works fine and I can install my licences very easy. First difference with ESX is that <span><span>XenCenter</span></span> is just an application, and doesn&#8217;t need a local database or anything like that.  And the licenses are directly installed on the host, this can be the case with ESX but preferably licenses are installed on a license server.

Next step is to create an Resource Pool (That&#8217;s what I thought). Within ESX is very easy to create a resource pool (first a <span><span>datacenter</span></span> and next is the resource pool). But within <span><span>XenServer</span></span> there is a requirement DNS must be properly configured before creating a resource pool. So when I want to run my DNS servers (in a new environment) on a virtual machine I first have to create a VM with DNS service, configure my <span><span>XenServers</span></span> to use these DNS servers and than continue. Without a DNS I can create a resource pool but cannot add a second server to it when name resolution is not in place.  One of the strong features of <span><span>XenServer</span></span> is that the configuration changes are saved on the <span><span>XenServers</span></span> and not within <span><span>XenCenter</span></span>. This way my <span><span>XenCenter</span></span> doesn&#8217;t have a key position unlike Virtual Center does.

I uploaded a windows server 2008 DVD to Dom0 of both Xenservers (not recommended) to get started. I&#8217;ve created two separate windows 2008 standard servers created a Domain with an Active Directory integrated DNS, and added both <span><span>XenServers</span></span> to the DNS. I configured the <span><span>XenServer</span></span> to use the DNS servers by using the build in console (<span><span>XSconsole</span></span>). I Know most CLI cracks prefer to configure these things by using very complicated command lines which works <span>as well</span>. Funny is the way you can access the command prompt of the servers just by clicking on a host, click on console and your in. Of Course Putty or other CLI tools work <span>as well</span>. When all was in place I create a resource pool and automatically one of <span><span>myXenservers</span></span> becomes the &#8220;master&#8221; and the other the &#8220;member&#8221; (Just to let you know).

As you can read in my &#8220;first impression&#8221; article I thought it was possible to create a HA environment without shared storage. This was not <span>entirely</span> true. You can do this but you need additional tooling (Marathon <span><span>Everrun</span></span> VM). The base HA feature build-in <span><span>XenCenter</span></span> which provides fail-over level 1 needs shared storage (and NFS doesn&#8217;t work) so you need <span><span>Iscsi</span></span>, <span><span>Fiberchannel</span></span>, <span><span>NetApp</span></span> or <span><span>EqualLogic</span></span>.  So what I thought was a big plus for <span><span>XenServer</span></span> turned out to be exactly the same as ESX HA. I&#8217;ve installed Marathon <span><span>Everrun</span></span> VM on both of my <span><span>XenServers</span></span> to create an environment where shared storage is not needed (because I don&#8217;t have shared storage at home of <span>course</span> you can create <span><span>Iscsi</span></span> targets on Windows or Linux machines with additional software but I choose the fancy way).  Installing Marathon <span><span>Everrun</span></span> VM takes about 5 minutes including the upload to the <span><span>XenServers</span></span>. Now I&#8217;m able to create a Level 2 protected Virtual Machine which <span>replicates</span> it&#8217;s  storage between the hosts. <span>Unfortunately</span> <span><span>Everrun</span></span> VM only supports Windows 2003 servers and not yet 2008. So the rest of my servers will be Windows 2003 servers.

I created a file share on one of my <span><span>DC&#8217;s</span></span> to store my <span><span>ISO&#8217;s</span></span> and create a new storage repository for my Resource Pool. I&#8217;ve seen these types of <span><span>SR&#8217;s</span></span> within ESX as well but I must say the configuration of storage repository&#8217;s is very easy within <span><span>XenServer</span></span>. On this ISO share I&#8217;ve uploaded the Windows 2003 <span><span>cd&#8217;s</span></span> and started creating a 2003 machine which I transformed to a template after the installation of <span><span>Xentools</span></span>. Unfortunately this is a one way operation unlike within ESX. When a template is created you first have to deploy a VM from it update it with whatever you want to do and than convert that updated VM to a new template and delete the old template (which I think is a weird situation). I&#8217;ve created the template on one of the <span><span>XenServers</span></span> and though it would be manageable to deploy a <span><span>VM</span></span> from this template to the other <span><span>XenServer</span></span> host (stupid me). Of course you need shared storage to deploy a template over more than one <span><span>XenServer</span></span> hosts. So I created a windows 2003 SR2 level 2 protected machine with enough disk space and a NFS share. I connected this NFS share to my resource pool and copied my template to the new Storage Repository. This way when one server fails the other one can take over the file server and my NFS share will still be in place.

<span>Last curious thing I would like to mention is the Virtual Machine configuration. Within ESX I&#8217;m used to build a virtual machine and tell what kid of hardware is in that virtual machine. All this hardware is placed within one tab. Within <span>XenCenter</span>, the Memory and vCPU are in a separate tab, storage is in a separate tab, networking is in a separate tab and a <span>dvd</span> can be created from two separate places. And most importantly I cannot configure other hardware than this (no com ports, <span>lpt</span> ports etc etc.). This is an issue which is not a big problem but when using specific hardware it might be a problem.</span> 

Finally I have a stable environment in which I can create and manage virtual machines without dedicated shared storage. As you can see it is manageable but it&#8217;s not an ideal situation. So my advice when using <span><span>XenServer</span></span> within an enterprise environment use shared storage. I think that <span><span>XenServer</span></span> is a very cool solution but still can use a lot of development. And with the release of ESX 4.0 upcoming they need to do this quick as well.

<span>Let me know what you&#8217;re experience is with <span>Xen</span> or <span>XenServer</span>&#8230;.</span>